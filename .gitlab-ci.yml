variables:
  PROJECT_PATH: 'Projekt'
  PATIENTS_DATA: 'PatientsData'
  DOCTORS_APP: 'DoctorsApp'
  PATIENT_WEB: 'PatientsWebApp'
  KUBERNETES: 'Miniprojekty/Kubernetes'

stages:
  - trigger

workflow:
  rules:
    - if: $CI_MERGE_REQUEST_IID
    - if: $CI_COMMIT_TAG
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH

trigger-patient-data:
  stage: trigger
  trigger:
    include: $PROJECT_PATH/$PATIENTS_DATA/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - $PROJECT_PATH/$PATIENTS_DATA/**/*
        - $KUBERNETES/$PATIENTS_DATA/**/*
         
trigger-doctors-app:
  stage: trigger
  trigger:
    include: $PROJECT_PATH/$DOCTORS_APP/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - $PROJECT_PATH/$DOCTORS_APP/**/*
        - $KUBERNETES/$DOCTORS_APP/**/*